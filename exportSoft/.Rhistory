library(readxl)
library(dplyr)
install.packages(c("readxl", "dplyr"))
library(readxl)
library(dplyr)
cat("Leyendo archivo Excel...\n")
excel_data <- read_excel("data.xlsx")
names(excel_data) <- gsub("[^a-zA-Z0-9_]", "_", names(excel_data))
names(excel_data) <- gsub("_+", "_", names(excel_data))
cat("Columnas encontradas:\n")
print(names(excel_data))
View(excel_data)
View(excel_data)
cat("Generando usuarios.csv...\n")
clientes <- excel_data %>%
select(nombre,	identificacion,	direccion,	telefono,	correo) %>%
distinct() %>%
write.csv(usuarios, "backend/data/clientes.csv", row.names = FALSE, quote = FALSE, fileEncoding = "UTF-8")
rm(list=ls())
library(readxl)
library(dplyr)
# Leer el archivo Excel
cat("Leyendo archivo Excel...\n")
excel_data <- read_excel("data.xlsx")
# Limpiar nombres de columnas
names(excel_data) <- gsub("[^a-zA-Z0-9_]", "_", names(excel_data))
names(excel_data) <- gsub("_+", "_", names(excel_data))
# Verificar la estructura de los datos
cat("Columnas encontradas:\n")
print(names(excel_data))
cat("Generando usuarios.csv...\n")
clientes <- excel_data %>%
select(nombre,	identificacion,	direccion,	telefono,	correo) %>%
distinct() %>%
write.csv(usuarios, "backend/data/clientes.csv", row.names = FALSE, quote = FALSE, fileEncoding = "UTF-8")
cat("Generando usuarios.csv...\n")
clientes <- excel_data %>%
select(nombre,	identificacion,	direccion,	telefono,	correo) %>%
distinct() %>%
write.csv(clientes, "backend/data/clientes.csv", row.names = FALSE, quote = FALSE, fileEncoding = "UTF-8")
cat("Generando usuarios.csv...\n")
clientes <- excel_data %>%
select(nombre,	identificacion,	direccion,	telefono,	correo) %>%
distinct() %>%
write.csv(clientes, "backend/data/clientes.csv", row.names = FALSE, quote = FALSE, fileEncoding = "UTF-8")
View(excel_data)
clientes <- excel_data %>%
select(nombre,	identificacion,	direccion,	telefono,	correo) %>%
distinct()
write.csv(clientes, "backend/data/clientes.csv", row.names = FALSE, quote = FALSE, fileEncoding = "UTF-8")
View(clientes)
cat("clientes.csv generado con", nrow(clientes), "registros\n")
rm(list=ls())
# Instalar paquetes si no los tienes (ejecutar solo la primera vez)
install.packages(c("readxl", "dplyr"))
# Cargar librerías
library(readxl)
library(dplyr)
# Leer el archivo Excel
cat("Leyendo archivo Excel...\n")
excel_data <- read_excel("data.xlsx")
# Limpiar nombres de columnas
names(excel_data) <- gsub("[^a-zA-Z0-9_]", "_", names(excel_data))
names(excel_data) <- gsub("_+", "_", names(excel_data))
# Verificar la estructura de los datos
cat("Columnas encontradas:\n")
print(names(excel_data))
# 1. Crear clientes.csv (usuarios únicos)
cat("Generando usuarios.csv...\n")
clientes <- excel_data %>%
select(nombre,	identificacion,	direccion,	telefono,	correo) %>%
distinct()
write.csv(clientes, "backend/data/clientes.csv", row.names = FALSE, quote = FALSE, fileEncoding = "UTF-8")
cat("clientes.csv generado con", nrow(clientes), "registros\n")
